<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hack University - Discord Login</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    :root {
      --color-primary: #1a73e8;
      --color-primary-hover: #1557b0;
      --color-text: #202124;
      --color-text-muted: #5f6368;
      --color-border: #dadce0;
      --color-bg: #f8f9fa;
      --color-bg-white: #fff;
      --radius-sm: 10px;
      --radius-md: 14px;
      --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
      --shadow-md: 0 8px 24px rgba(2,16,44,.10);
      --transition-base: .18s ease;
      --navbar-h: 64px;
      --navbar-h-m: 72px;
      --clock-bar-h: 44px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Google Sans","Roboto",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color: var(--color-text);
      background: var(--color-bg);
      min-height: 100vh;
      padding-top: calc(var(--navbar-h) + var(--clock-bar-h));
    }
    a { color: inherit; text-decoration: none; }

    .navbar {
      background: var(--color-bg-white);
      border-bottom: 1px solid var(--color-border);
      padding: 12px 0;
      box-shadow: var(--shadow-sm);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 2000;
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
    }
    .nav-brand { display: flex; flex-direction: column; line-height: 1.1; }
    .brand-title, .brand-url { display: inline-block; white-space: nowrap; }
    .brand-title { font-weight: 700; font-size: clamp(0.95rem, 3vw, 1.25rem); color: var(--color-primary); }
    .brand-url { font-size: clamp(0.8rem, 2.5vw, 1.05rem); color: #0f766e; text-decoration: underline; }

    .nav-links { display: flex; gap: 18px; flex-wrap: wrap; }
    .nav-link {
      color: var(--color-text-muted);
      font-weight: 500;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: var(--radius-sm);
      transition: all var(--transition-base);
    }
    .nav-link:hover { color: var(--color-primary); background: #f1f3f4; }

    .nav-toggle {
      display: none;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--color-border);
      background: var(--color-bg-white);
      color: var(--color-text);
      box-shadow: var(--shadow-sm);
      transition: all var(--transition-base);
    }

    .event-clock-bar {
      position: fixed;
      top: var(--navbar-h);
      left: 0;
      right: 0;
      z-index: 1900;
      height: var(--clock-bar-h);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: #fff;
      border-bottom: 1px solid var(--color-border);
      box-shadow: var(--shadow-sm);
      padding: 0 14px;
    }

    .event-clock-label {
      font-size: 12.5px;
      color: var(--color-text-muted);
      font-weight: 700;
      white-space: nowrap;
    }

    .event-clock-time {
      font-size: 13px;
      font-weight: 900;
      color: var(--color-text);
      white-space: nowrap;
    }

    .event-clock-date {
      font-size: 12.5px;
      color: var(--color-text-muted);
      white-space: nowrap;
    }

    .container { max-width: 880px; margin: 0 auto; padding: 28px 18px 46px; }
    .card {
      background: var(--color-bg-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 26px;
    }
    h1 { margin: 0; font-size: clamp(1.7rem, 4vw, 2.5rem); line-height: 1.16; }
    .sub { color: var(--color-text-muted); margin: 10px 0 0; line-height: 1.55; }

    label { display: block; font-weight: 600; font-size: .9rem; margin: 18px 0 7px; }
    input {
      width: 100%;
      border: 1px solid var(--color-border);
      border-radius: 10px;
      padding: 12px 14px;
      font-size: .96rem;
      outline: none;
      transition: border-color .18s ease, box-shadow .18s ease;
    }
    input:focus { border-color: #8ab4ff; box-shadow: 0 0 0 4px rgba(26,115,232,.12); }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 999px;
      border: 0;
      font-weight: 700;
      cursor: pointer;
      transition: all .16s ease;
      text-decoration: none;
    }
    .btn-main { background: var(--color-primary); color: #fff; width: 100%; margin-top: 12px; }
    .btn-main:hover { background: var(--color-primary-hover); }

    .status {
      margin-top: 12px;
      padding: 11px 12px;
      border-radius: 10px;
      font-size: .9rem;
      border: 1px solid transparent;
      display: none;
    }
    .status.show { display: block; }
    .status.info { background: #e8f0fe; color: #174ea6; border-color: #bfd4ff; }
    .status.success { background: #e6f4ea; color: #0f5132; border-color: #b7dec2; }
    .status.error { background: #fdeaea; color: #842029; border-color: #f3c2c7; }

    .result {
      margin-top: 18px;
      border: 1px solid #cfe0ff;
      border-radius: 12px;
      background: #f4f8ff;
      padding: 16px;
      display: none;
    }
    .result-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .btn-main-tight {
      margin-top: 0;
      border-radius: 12px;
      padding: 10px 12px;
      min-height: 44px;
      font-size: .9rem;
      font-weight: 700;
      line-height: 1.25;
      text-align: center;
      white-space: normal;
    }
    .community-box {
      margin-top: 14px;
      background: #fff;
      border: 1px solid #dbe7ff;
      border-radius: 10px;
      padding: 12px;
    }
    .community-title {
      margin: 0 0 10px;
      font-size: 1rem;
      color: #1f3f7f;
    }
    .community-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .btn-org {
      margin-top: 0;
      border-radius: 10px;
      padding: 10px 12px;
      min-height: 44px;
      font-size: .85rem;
      font-weight: 700;
      line-height: 1.2;
      background: #eef4ff;
      color: #174ea6;
      border: 1px solid #c7dafd;
      text-align: center;
      white-space: normal;
    }
    .btn-org:hover {
      background: #e3edff;
      color: #113b83;
    }
    .community-full { grid-column: 1 / -1; }

    .footer { background: var(--color-primary); color: #fff; padding: 32px 0 48px; margin-top: 24px; }
    .footer-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .footer a { color: #e3f2ff; text-decoration: none; transition: opacity .2s ease; }
    .footer a:hover { opacity: .95; text-decoration: underline; }
    .footer-grid { display: grid; grid-template-columns: 1.3fr 1fr 1fr; gap: 24px; align-items: start; }
    .footer h4 { font-size: 20px; font-weight: 700; margin-bottom: 12px; }
    .footer p { font-size: 15px; opacity: .95; line-height: 1.6; margin: 10px 0; }
    .footer ul { list-style: none; padding: 0; margin: 0; }
    .footer li { margin: 8px 0; }

    .social-grid {
      display: grid;
      grid-template-columns: repeat(6, minmax(60px,1fr));
      gap: 10px 12px;
      margin-top: 10px;
    }
    .social-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      background: rgba(255,255,255,.08);
      transition: transform .15s ease, background .15s ease;
    }
    .social-btn:hover { transform: translateY(-2px); background: rgba(255,255,255,.16); }

    .footer-bottom {
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing-lg);
      border-top: 1px solid rgba(255,255,255,.25);
      text-align: center;
    }
    .footer-bottom p { margin: 0 0 8px; font-size: 14px; opacity: .95; }
    .footer-bottom .credits { font-size: 13px; opacity: .92; }
    .footer-bottom .credits a { color: #bfe6ff; font-weight: 600; }

    @media (max-width: 960px) { .footer-grid { grid-template-columns: 1fr 1fr; } }

    @media (max-width: 768px) {
      .nav-toggle { display: inline-flex; }
      .nav-links { display: none; width: 100%; flex-direction: column; gap: 8px; padding-top: 12px; }
      .nav-links.is-open { display: flex; }
      .nav-container { flex-wrap: wrap; gap: 10px; }
      .nav-link { width: 100%; padding: 10px 12px; }
      .event-clock-bar { top: var(--navbar-h-m); }
      body { padding-top: calc(var(--navbar-h-m) + var(--clock-bar-h)); }
      .result-actions { grid-template-columns: 1fr; }
      .community-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 640px) {
      .footer-grid { grid-template-columns: 1fr; }
      .social-grid { grid-template-columns: repeat(3, minmax(80px,1fr)); }
      .footer { padding-bottom: 32px; }
      .event-clock-bar { height: 40px; padding: 0 10px; }
      .event-clock-time { font-size: 12.5px; }
      .event-clock-date { display: none; }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <a href="https://hackuniversity.vercel.app/" aria-label="Hack University Worldwide Home" class="brand-title">Hack University Worldwide Initiative</a>
        <a href="https://hackuniversity.vercel.app/" class="brand-url">HackUniversity.vercel.app / Home</a>
      </div>

      <button class="nav-toggle" type="button" aria-label="Toggle navigation" aria-controls="huNavLinks" aria-expanded="false">
        <i class="fa-solid fa-bars"></i>
      </button>

      <div class="nav-links" id="huNavLinks">
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity.html#partners">Partners</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity.html#mission">Mission</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackathons.html" target="_blank" rel="noopener noreferrer">Hackathons</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity-calendar.html" target="_blank" rel="noopener noreferrer">Calendar</a>
      </div>
    </div>
  </nav>

  <div class="event-clock-bar" role="status" aria-label="Event Clock - Eastern Time">
    <span class="event-clock-label">Organization Clock - <strong>Eastern Time (ET)</strong> · Miami, FL</span>
    <span id="et-clock" class="event-clock-time"></span>
    <span class="event-clock-date">(<span id="et-date"></span>)</span>
  </div>

  <main class="container">
    <section class="card">
      <h1>Discord Access Login</h1>
      <p class="sub">Enter the same OneStop email used during registration. After verification, your Discord access will unlock.</p>

      <form id="discord-login-form" novalidate>
        <label for="member-email">Registered Gmail / Google Account</label>
        <input id="member-email" type="email" autocomplete="email" placeholder="example@fiu.edu or example@gmail.com" required />
        <button id="verify-btn" type="submit" class="btn btn-main"><i class="fa-solid fa-shield-check"></i> Verify Membership</button>
      </form>

      <div id="status" class="status" role="status" aria-live="polite"></div>

      <div id="result" class="result">
        <p>Welcome <strong id="welcome-name">Member</strong>. Your membership is verified and Discord access is ready.</p>
        <div class="result-actions">
          <a id="discord-link" class="btn btn-main btn-main-tight" href="#" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-discord"></i> Join Hackathon Discord</a>
          <a id="groupme-link" class="btn btn-main btn-main-tight" href="#" target="_blank" rel="noopener noreferrer"><i class="fa-solid fa-users"></i> Join Hackathon GroupMe</a>
        </div>

        <div class="community-box">
          <h3 class="community-title">🌐 Join Organization-Specific Communities</h3>
          <div class="community-grid">
            <a class="btn btn-org" href="https://codecrunchglobal-discordserver.vercel.app/" target="_blank" rel="noopener noreferrer">Code Crunch Global Discord</a>
            <a class="btn btn-org" href="https://colorstackatfiu-discordserver.vercel.app/" target="_blank" rel="noopener noreferrer">ColorStack at FIU Discord</a>
            <a class="btn btn-org" href="https://cahsiatfiu-discordserver.vercel.app/" target="_blank" rel="noopener noreferrer">CAHSI at FIU Discord</a>
            <a class="btn btn-org" href="https://gdgatfiu-discordserver.vercel.app/" target="_blank" rel="noopener noreferrer">Google Developer Group (GDG) at FIU Discord</a>
            <a class="btn btn-org community-full" href="https://codecrunchglobal-discordserver.vercel.app/" target="_blank" rel="noopener noreferrer">Raspberry Pi Code Crunch Discord</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-container">
      <div class="footer-grid">
        <div>
          <h4>Hack University</h4>
          <p>Empowering the next generation of innovators through collaboration and hands-on learning.</p>
          <a class="inline-block mt-2 font-semibold" href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener">HackUniversity.vercel.app -></a>

          <div class="social-grid">
            <a class="social-btn" href="https://www.linkedin.com/showcase/hack-university-global/" target="_blank" rel="noopener"><i class="fab fa-linkedin"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-github"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-youtube"></i></a>
            <a class="social-btn" href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-discord"></i></a>
            <a class="social-btn" href="https://hackuniversity-calendar.vercel.app/" target="_blank" rel="noopener"><i class="far fa-calendar-alt"></i></a>
          </div>
        </div>

        <div>
          <h4>Quick Links</h4>
          <ul>
            <li><a href="https://codecrunchglobal.vercel.app/hackuniversity.html#mission">Mission</a></li>
            <li><a href="https://hackuniversity-calendar.vercel.app/" target="_blank" rel="noopener">Events</a></li>
            <li><a href="https://photos.app.goo.gl/71FC5SLTQcPRbXjx6" target="_blank" rel="noopener">Photo Album</a></li>
            <li><a href="https://codecrunchglobal.vercel.app/hackathons.html" target="_blank" rel="noopener">Hackathons</a></li>
            <li><a href="https://hackuniversity-membership.vercel.app/" target="_blank" rel="noopener">Membership</a></li>
            <li><a href="https://hackuniversity-eboard.vercel.app/" target="_blank" rel="noopener">Join E-Board</a></li>
            <li><a href="https://codecrunchglobal.vercel.app/index.html#resources" target="_blank" rel="noopener">Resources</a></li>
            <li><a href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener">Join Discord</a></li>
          </ul>
        </div>

        <div>
          <h4>Contact</h4>
          <address style="font-style: normal; font-size: 14px; line-height: 1.7; opacity: .9;">
            Florida International University<br>
            Miami, FL<br>
            <a href="mailto:codecrunchclub@gmail.com">codecrunchclub@gmail.com</a>
          </address>
        </div>
      </div>

      <div class="footer-bottom">
        <p>(c) 2025 Hack University.</p>
        <div class="credits">Built with care by <a href="https://www.linkedin.com/in/iba001/" target="_blank" rel="noopener">Brian Bazurto</a>.</div>
      </div>
    </div>
  </footer>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbzAhhReD7EpGsT_biQmcuqsMu1t1wCs4MQTGuGpGKax1EisZvT_8qtyBKQMPStcpyHXqA/exec";
    const DEFAULT_DISCORD_URL = "https://hackuniversity-discord.vercel.app/";

    const form = document.getElementById("discord-login-form");
    const emailInput = document.getElementById("member-email");
    const verifyBtn = document.getElementById("verify-btn");
    const statusEl = document.getElementById("status");
    const resultEl = document.getElementById("result");
    const welcomeName = document.getElementById("welcome-name");
    const discordLink = document.getElementById("discord-link");
    const groupmeLink = document.getElementById("groupme-link");

    function setStatus(type, message) {
      statusEl.className = `status show ${type}`;
      statusEl.textContent = message;
    }

    function clearStatus() {
      statusEl.className = "status";
      statusEl.textContent = "";
    }

    async function verifyMembership(evt) {
      evt.preventDefault();
      resultEl.style.display = "none";
      clearStatus();

      const email = (emailInput.value || "").trim().toLowerCase();
      if (!email) return setStatus("error", "Please enter your email address.");
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return setStatus("error", "Please enter a valid email address.");

      verifyBtn.disabled = true;
      const original = verifyBtn.innerHTML;
      verifyBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Verifying...';
      setStatus("info", "Checking your membership...");

      try {
        const reqUrl = `${API_URL}?email=${encodeURIComponent(email)}&referer=${encodeURIComponent(window.location.href)}`;
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), 15000);
        const res = await fetch(reqUrl, { signal: controller.signal, headers: { Accept: "application/json" } });
        clearTimeout(t);

        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        if (data && data.error) throw new Error(data.error);

        const rows = Array.isArray(data?.certificates) ? data.certificates : [];
        if (!rows.length) return setStatus("error", "No membership found for this email.");

        const chosen = rows
          .map((c) => c.certificateData || c)
          .filter(Boolean)
          .sort((a, b) => new Date(b.memberDateSince || 0) - new Date(a.memberDateSince || 0))[0] || {};

        welcomeName.textContent = chosen.participantName || "Member";
        discordLink.href = chosen.discordJoinLink || DEFAULT_DISCORD_URL;
        groupmeLink.href = chosen.groupmeLink || "https://codecrunchglobal-groupme.vercel.app/";
        resultEl.style.display = "block";
        setStatus("success", "Membership verified. Continue to Discord.");
      } catch (err) {
        if (err?.name === "AbortError") setStatus("error", "Request timed out. Please try again.");
        else setStatus("error", "Could not verify right now. Please try again.");
      } finally {
        verifyBtn.disabled = false;
        verifyBtn.innerHTML = original;
      }
    }

    form.addEventListener("submit", verifyMembership);

    (function navToggle() {
      const toggleBtn = document.querySelector(".nav-toggle");
      const navLinks = document.getElementById("huNavLinks");
      if (!toggleBtn || !navLinks) return;
      const setExpanded = (expanded) => {
        toggleBtn.setAttribute("aria-expanded", String(expanded));
        navLinks.classList.toggle("is-open", expanded);
        const icon = toggleBtn.querySelector("i");
        if (icon) icon.className = expanded ? "fa-solid fa-xmark" : "fa-solid fa-bars";
      };
      toggleBtn.addEventListener("click", () => {
        const expanded = toggleBtn.getAttribute("aria-expanded") === "true";
        setExpanded(!expanded);
      });
      navLinks.addEventListener("click", (e) => {
        const a = e.target.closest("a");
        if (!a) return;
        const href = a.getAttribute("href") || "";
        if (href.startsWith("#")) setExpanded(false);
      });
      window.addEventListener("resize", () => {
        if (window.innerWidth > 768) setExpanded(false);
      });
      setExpanded(false);
    })();

    (function startETClock() {
      const clockEl = document.getElementById("et-clock");
      const dateEl = document.getElementById("et-date");
      if (!clockEl || !dateEl) return;
      const tz = "America/New_York";
      const tick = () => {
        const now = new Date();
        const timeStr = new Intl.DateTimeFormat("en-US", { timeZone: tz, hour: "numeric", minute: "2-digit", second: "2-digit", hour12: true }).format(now);
        const dateStr = new Intl.DateTimeFormat("en-US", { timeZone: tz, weekday: "short", month: "short", day: "numeric", year: "numeric" }).format(now);
        clockEl.textContent = `${timeStr} ET`;
        dateEl.textContent = dateStr;
      };
      tick();
      setInterval(tick, 1000);
    })();
  </script>
</body>
</html>
