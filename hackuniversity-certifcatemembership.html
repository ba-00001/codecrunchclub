<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hack University - Membership Certificates</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    :root {
      --color-primary: #1a73e8;
      --color-primary-hover: #1557b0;
      --color-text: #202124;
      --color-text-muted: #5f6368;
      --color-border: #dadce0;
      --color-bg: #f8f9fa;
      --color-bg-white: #fff;
      --radius-sm: 10px;
      --radius-md: 14px;
      --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
      --shadow-md: 0 8px 24px rgba(2,16,44,.10);
      --transition-base: .18s ease;
      --navbar-h: 64px;
      --navbar-h-m: 72px;
      --clock-bar-h: 44px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Google Sans","Roboto",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color: var(--color-text);
      background: var(--color-bg);
      min-height: 100vh;
      padding-top: calc(var(--navbar-h) + var(--clock-bar-h));
    }
    a { color: inherit; text-decoration: none; }

    .navbar {
      background: var(--color-bg-white);
      border-bottom: 1px solid var(--color-border);
      padding: 12px 0;
      box-shadow: var(--shadow-sm);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 2000;
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
    }
    .nav-brand { display: flex; flex-direction: column; line-height: 1.1; }
    .brand-title, .brand-url { display: inline-block; white-space: nowrap; }
    .brand-title { font-weight: 700; font-size: clamp(0.95rem, 3vw, 1.25rem); color: var(--color-primary); }
    .brand-url { font-size: clamp(0.8rem, 2.5vw, 1.05rem); color: #0f766e; text-decoration: underline; }

    .nav-links { display: flex; gap: 18px; flex-wrap: wrap; }
    .nav-link {
      color: var(--color-text-muted);
      font-weight: 500;
      font-size: 14px;
      padding: 8px 12px;
      border-radius: var(--radius-sm);
      transition: all var(--transition-base);
    }
    .nav-link:hover { color: var(--color-primary); background: #f1f3f4; }

    .nav-toggle {
      display: none;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--color-border);
      background: var(--color-bg-white);
      color: var(--color-text);
      box-shadow: var(--shadow-sm);
      transition: all var(--transition-base);
    }

    .event-clock-bar {
      position: fixed;
      top: var(--navbar-h);
      left: 0;
      right: 0;
      z-index: 1900;
      height: var(--clock-bar-h);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: #fff;
      border-bottom: 1px solid var(--color-border);
      box-shadow: var(--shadow-sm);
      padding: 0 14px;
    }

    .event-clock-label {
      font-size: 12.5px;
      color: var(--color-text-muted);
      font-weight: 700;
      white-space: nowrap;
    }

    .event-clock-time {
      font-size: 13px;
      font-weight: 900;
      color: var(--color-text);
      white-space: nowrap;
    }

    .event-clock-date {
      font-size: 12.5px;
      color: var(--color-text-muted);
      white-space: nowrap;
    }

    .container { max-width: 880px; margin: 0 auto; padding: 28px 18px 46px; }
    .card {
      background: var(--color-bg-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 26px;
    }
    h1 { margin: 0; font-size: clamp(1.7rem, 4vw, 2.5rem); line-height: 1.16; }
    .sub { color: var(--color-text-muted); margin: 10px 0 0; line-height: 1.55; }

    label { display: block; font-weight: 600; font-size: .9rem; margin: 18px 0 7px; }
    input {
      width: 100%;
      border: 1px solid var(--color-border);
      border-radius: 10px;
      padding: 12px 14px;
      font-size: .96rem;
      outline: none;
      transition: border-color .18s ease, box-shadow .18s ease;
    }
    input:focus { border-color: #8ab4ff; box-shadow: 0 0 0 4px rgba(26,115,232,.12); }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 999px;
      border: 0;
      font-weight: 700;
      cursor: pointer;
      transition: all .16s ease;
      text-decoration: none;
    }
    .btn-main { background: var(--color-primary); color: #fff; width: 100%; margin-top: 12px; }
    .btn-main:hover { background: var(--color-primary-hover); }

    .status {
      margin-top: 12px;
      padding: 11px 12px;
      border-radius: 10px;
      font-size: .9rem;
      border: 1px solid transparent;
      display: none;
    }
    .status.show { display: block; }
    .status.info { background: #e8f0fe; color: #174ea6; border-color: #bfd4ff; }
    .status.success { background: #e6f4ea; color: #0f5132; border-color: #b7dec2; }
    .status.error { background: #fdeaea; color: #842029; border-color: #f3c2c7; }

    .result {
      margin-top: 18px;
      border: 1px solid #cfe0ff;
      border-radius: 12px;
      background: #f4f8ff;
      padding: 16px;
      display: none;
    }
    .memberships-box {
      margin-top: 14px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      border-radius: 10px;
      padding: 14px;
    }
    .memberships-title {
      margin: 0 0 10px;
      font-size: 1.02rem;
      font-weight: 800;
      color: #1e3a8a;
      text-align: center;
    }
    .memberships-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }
    .membership-card {
      background: #fff;
      border: 1px solid #dbeafe;
      border-radius: 9px;
      padding: 10px;
      text-align: center;
    }
    .membership-logo {
      width: 46px;
      height: 46px;
      object-fit: contain;
      display: block;
      margin: 0 auto 7px;
    }
    .membership-name {
      font-size: .86rem;
      font-weight: 700;
      color: #1f2937;
      line-height: 1.3;
    }
    .membership-desc {
      font-size: .75rem;
      color: #64748b;
      margin-top: 3px;
      line-height: 1.25;
    }
    .membership-status {
      margin-top: 6px;
      font-size: .76rem;
      font-weight: 700;
      color: #15803d;
    }
    .memberships-note {
      margin: 10px 0 0;
      text-align: center;
      color: #2563eb;
      font-size: .78rem;
      font-style: italic;
    }

    .footer { background: var(--color-primary); color: #fff; padding: 32px 0 48px; margin-top: 24px; }
    .footer-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .footer a { color: #e3f2ff; text-decoration: none; transition: opacity .2s ease; }
    .footer a:hover { opacity: .95; text-decoration: underline; }
    .footer-grid { display: grid; grid-template-columns: 1.3fr 1fr 1fr; gap: 24px; align-items: start; }
    .footer h4 { font-size: 20px; font-weight: 700; margin-bottom: 12px; }
    .footer p { font-size: 15px; opacity: .95; line-height: 1.6; margin: 10px 0; }
    .footer ul { list-style: none; padding: 0; margin: 0; }
    .footer li { margin: 8px 0; }

    .social-grid {
      display: grid;
      grid-template-columns: repeat(6, minmax(60px,1fr));
      gap: 10px 12px;
      margin-top: 10px;
    }
    .social-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      background: rgba(255,255,255,.08);
      transition: transform .15s ease, background .15s ease;
    }
    .social-btn:hover { transform: translateY(-2px); background: rgba(255,255,255,.16); }

    .footer-bottom {
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing-lg);
      border-top: 1px solid rgba(255,255,255,.25);
      text-align: center;
    }
    .footer-bottom p { margin: 0 0 8px; font-size: 14px; opacity: .95; }
    .footer-bottom .credits { font-size: 13px; opacity: .92; }
    .footer-bottom .credits a { color: #bfe6ff; font-weight: 600; }

    @media (max-width: 960px) { .footer-grid { grid-template-columns: 1fr 1fr; } }

    @media (max-width: 768px) {
      .nav-toggle { display: inline-flex; }
      .nav-links { display: none; width: 100%; flex-direction: column; gap: 8px; padding-top: 12px; }
      .nav-links.is-open { display: flex; }
      .nav-container { flex-wrap: wrap; gap: 10px; }
      .nav-link { width: 100%; padding: 10px 12px; }
      .event-clock-bar { top: var(--navbar-h-m); }
      body { padding-top: calc(var(--navbar-h-m) + var(--clock-bar-h)); }
      .memberships-grid { grid-template-columns: 1fr 1fr; }
    }

    @media (max-width: 640px) {
      .footer-grid { grid-template-columns: 1fr; }
      .social-grid { grid-template-columns: repeat(3, minmax(80px,1fr)); }
      .footer { padding-bottom: 32px; }
      .event-clock-bar { height: 40px; padding: 0 10px; }
      .event-clock-time { font-size: 12.5px; }
      .event-clock-date { display: none; }
      .memberships-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <a href="https://hackuniversity.vercel.app/" aria-label="Hack University Worldwide Home" class="brand-title">Hack University Worldwide Initiative</a>
        <a href="https://hackuniversity.vercel.app/" class="brand-url">HackUniversity.vercel.app / Home</a>
      </div>
      <button class="nav-toggle" type="button" aria-label="Toggle navigation" aria-controls="huNavLinks" aria-expanded="false">
        <i class="fa-solid fa-bars"></i>
      </button>
      <div class="nav-links" id="huNavLinks">
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity.html#partners">Partners</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity.html#mission">Mission</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackathons.html" target="_blank" rel="noopener noreferrer">Hackathons</a>
        <a class="nav-link" href="https://codecrunchglobal.vercel.app/hackuniversity.html#calendar" target="_blank" rel="noopener noreferrer">Calendar</a>
      </div>
    </div>
  </nav>

  <div class="event-clock-bar" role="status" aria-label="Event Clock - Eastern Time">
    <span class="event-clock-label">Organization Clock - <strong>Eastern Time (ET)</strong> · Miami, FL</span>
    <span id="et-clock" class="event-clock-time"></span>
    <span class="event-clock-date">(<span id="et-date"></span>)</span>
  </div>

  <main class="container">
    <section class="card">
      <h1>Membership Certificate Access</h1>
      <p class="sub">Use the same OneStop email to verify your membership and generate your official membership certificate.</p>

      <form id="cert-form" novalidate>
        <label for="member-email">Registered Gmail / Google Account</label>
        <input id="member-email" type="email" autocomplete="email" placeholder="example@fiu.edu or example@gmail.com" required />
        <button id="verify-btn" type="submit" class="btn btn-main"><i class="fa-solid fa-shield-check"></i> Verify Membership</button>
      </form>

      <div id="cert-status" class="status" role="status" aria-live="polite"></div>

      <div id="cert-result" class="result">
        <p>Welcome <strong id="welcome-name">Member</strong>. Your membership is verified.</p>
        <button id="download-certificate" type="button" class="btn btn-main"><i class="fa-solid fa-download"></i> Download Membership Certificate</button>

        <div class="memberships-box" id="user-club-memberships">
          <h3 class="memberships-title">Your Active Club Memberships</h3>
          <div id="user-clubs-grid" class="memberships-grid"></div>
          <p class="memberships-note">Based on our records for your email address (all matching submissions)</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-container">
      <div class="footer-grid">
        <div>
          <h4>Hack University</h4>
          <p>Empowering the next generation of innovators through collaboration and hands-on learning.</p>
          <a class="inline-block mt-2 font-semibold" href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener">HackUniversity.vercel.app -></a>

          <div class="social-grid">
            <a class="social-btn" href="https://www.linkedin.com/showcase/hack-university-global/" target="_blank" rel="noopener"><i class="fab fa-linkedin"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-github"></i></a>
            <a class="social-btn" href="https://hackuniversity-directory.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-youtube"></i></a>
            <a class="social-btn" href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener"><i class="fab fa-discord"></i></a>
            <a class="social-btn" href="https://hackuniversity-calendar.vercel.app/" target="_blank" rel="noopener"><i class="far fa-calendar-alt"></i></a>
          </div>
        </div>

        <div>
          <h4>Quick Links</h4>
          <ul>
            <li><a href="https://codecrunchglobal.vercel.app/hackuniversity.html#mission">Mission</a></li>
            <li><a href="https://hackuniversity-calendar.vercel.app/" target="_blank" rel="noopener">Events</a></li>
            <li><a href="https://photos.app.goo.gl/71FC5SLTQcPRbXjx6" target="_blank" rel="noopener">Photo Album</a></li>
            <li><a href="https://codecrunchglobal.vercel.app/hackathons.html" target="_blank" rel="noopener">Hackathons</a></li>
            <li><a href="https://hackuniversity-membership.vercel.app/" target="_blank" rel="noopener">Membership</a></li>
            <li><a href="https://hackuniversity-eboard.vercel.app/" target="_blank" rel="noopener">Join E-Board</a></li>
            <li><a href="https://codecrunchglobal.vercel.app/index.html#resources" target="_blank" rel="noopener">Resources</a></li>
            <li><a href="https://hackuniversity-discord.vercel.app/" target="_blank" rel="noopener">Join Discord</a></li>
          </ul>
        </div>

        <div>
          <h4>Contact</h4>
          <address style="font-style: normal; font-size: 14px; line-height: 1.7; opacity: .9;">
            Florida International University<br>
            Miami, FL<br>
            <a href="mailto:codecrunchclub@gmail.com">codecrunchclub@gmail.com</a>
          </address>
        </div>
      </div>

      <div class="footer-bottom">
        <p>(c) 2025 Hack University.</p>
        <div class="credits">Built with care by <a href="https://www.linkedin.com/in/iba001/" target="_blank" rel="noopener">Brian Bazurto</a>.</div>
      </div>
    </div>
  </footer>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbzAhhReD7EpGsT_biQmcuqsMu1t1wCs4MQTGuGpGKax1EisZvT_8qtyBKQMPStcpyHXqA/exec";
    const SIGNATURE_URL = "https://github.com/user-attachments/assets/02be41eb-2259-4d6d-9a07-1122f79d6f4b";
    const ALL_ORGS_TEXT = "Google Developer Club at FIU, Code Crunch Worldwide, ColorStack at FIU, CAHSI at FIU, and Raspberry Pi Code Crunch";
    let certificateData = null;

    const form = document.getElementById("cert-form");
    const emailInput = document.getElementById("member-email");
    const verifyBtn = document.getElementById("verify-btn");
    const statusEl = document.getElementById("cert-status");
    const resultEl = document.getElementById("cert-result");
    const welcomeEl = document.getElementById("welcome-name");
    const downloadBtn = document.getElementById("download-certificate");
    const clubsGrid = document.getElementById("user-clubs-grid");

    function setStatus(type, message) {
      statusEl.className = `status show ${type}`;
      statusEl.textContent = message;
    }

    function clearStatus() {
      statusEl.className = "status";
      statusEl.textContent = "";
    }

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/\"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    function displayUserClubMemberships(clubs) {
      if (!clubsGrid) return;
      clubsGrid.innerHTML = "";

      const fallbackLogo = "https://github.com/user-attachments/assets/223a12cb-c5ea-4009-a442-2ad144c8e1d6";
      const catalog = [
        {
          name: "Hack University Worldwide",
          description: "",
          logo: "https://hackuniversity.vercel.app/favicon.ico"
        },
        {
          name: "Code Crunch Global",
          description: "Main coding and hackathon community",
          logo: "https://github.com/user-attachments/assets/5e2a6622-9702-438f-bb6b-25d8e894839e"
        },
        {
          name: "ColorStack at FIU",
          description: "Career development in tech",
          logo: "https://github.com/user-attachments/assets/b5a58539-32be-42b8-9148-b7e8a8d4afea"
        },
        {
          name: "CAHSI at FIU",
          description: "Advancement & support for computing pathways",
          logo: "https://github.com/user-attachments/assets/c4f4805e-db3b-47a2-9a7f-0b124a66dd85"
        },
        {
          name: "Google Developer Group at FIU",
          description: "Google technologies and development",
          logo: "https://github.com/user-attachments/assets/f62d5d75-d45f-4c01-b444-1c99a4031e27"
        },
        {
          name: "Raspberry Pi Code Crunch",
          description: "Hardware programming and IoT projects",
          logo: "https://github.com/user-attachments/assets/1eaf8425-7b4b-4035-a84b-b9b0ed28c52c"
        }
      ];

      const byName = new Map(catalog.map((c) => [c.name.toLowerCase(), c]));
      const activeNames = new Set();
      clubs.forEach((club) => {
        const n = (club?.name || "").trim().toLowerCase();
        if (!n) return;
        activeNames.add(n);
      });

      // Always include Hack University Worldwide as umbrella membership.
      activeNames.add("hack university worldwide");

      const ordered = catalog.filter((item) => activeNames.has(item.name.toLowerCase()));

      ordered.forEach((club) => {
        const card = document.createElement("div");
        card.className = "membership-card";
        card.innerHTML = `
          <img class="membership-logo" src="${escapeHtml(club.logo || fallbackLogo)}" alt="${escapeHtml(club.name)} Logo" onerror="this.onerror=null;this.src='${fallbackLogo}'">
          <div class="membership-name">${escapeHtml(club.name)}</div>
          ${club.description ? `<div class="membership-desc">${escapeHtml(club.description)}</div>` : ""}
          <div class="membership-status">✅ Active Member</div>
        `;
        clubsGrid.appendChild(card);
      });
    }

    async function verifyMembership(evt) {
      evt.preventDefault();
      resultEl.style.display = "none";
      clearStatus();

      const email = (emailInput.value || "").trim().toLowerCase();
      if (!email) return setStatus("error", "Please enter your email address.");
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return setStatus("error", "Please enter a valid email address.");

      verifyBtn.disabled = true;
      const original = verifyBtn.innerHTML;
      verifyBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Verifying...';
      setStatus("info", "Checking your membership...");

      try {
        const reqUrl = `${API_URL}?email=${encodeURIComponent(email)}&referer=${encodeURIComponent(window.location.href)}`;
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), 15000);
        const res = await fetch(reqUrl, { signal: controller.signal, headers: { Accept: "application/json" } });
        clearTimeout(t);

        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        if (data && data.error) throw new Error(data.error);

        const rows = Array.isArray(data?.certificates) ? data.certificates : [];
        if (!rows.length) return setStatus("error", "No membership found for this email.");

        const flat = rows
          .map((c) => c.certificateData || c)
          .filter(Boolean);

        const chosen = flat
          .sort((a, b) => new Date(b.memberDateSince || 0) - new Date(a.memberDateSince || 0))[0] || {};

        const clubMap = new Map();
        flat.forEach((entry) => {
          (entry.clubs || []).forEach((club) => {
            const key = (club.name || "").toLowerCase();
            if (!key) return;
            if (!clubMap.has(key)) clubMap.set(key, { name: club.name || "" });
          });
        });
        displayUserClubMemberships(Array.from(clubMap.values()));

        certificateData = chosen;
        welcomeEl.textContent = chosen.participantName || "Member";
        resultEl.style.display = "block";
        setStatus("success", "Membership verified. You can download your certificate.");
      } catch (err) {
        if (err?.name === "AbortError") setStatus("error", "Request timed out. Please try again.");
        else setStatus("error", "Could not verify right now. Please try again.");
      } finally {
        verifyBtn.disabled = false;
        verifyBtn.innerHTML = original;
      }
    }

    function downloadCertificate() {
      if (!certificateData) {
        alert("Verify membership first.");
        return;
      }
      const c = certificateData;

      const certificateHTML = `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Hack University Membership Certificate - ${escapeHtml(c.participantName || "Member")}</title>
<style>
  @page { size: A4 landscape; margin: 0; }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: "Times New Roman", Georgia, serif; background: #ececec; padding: 24px; }
  .sheet { max-width: 1120px; margin: 0 auto; background: #fdfcf7; border: 14px solid #b8860b; box-shadow: 0 14px 36px rgba(0,0,0,.25); }
  .inner { border: 2px solid #d4af37; margin: 16px; padding: 38px 58px; min-height: 620px; }
  .title { text-align: center; font-size: 2.5rem; letter-spacing: .25em; margin-bottom: 8px; }
  .subtitle { text-align: center; font-size: .95rem; letter-spacing: .32em; color: #6b7280; margin-bottom: 30px; }
  .presented { text-align: center; font-style: italic; color: #4b5563; margin-bottom: 16px; }
  .name { text-align: center; font-size: 2.5rem; font-weight: 700; margin-bottom: 24px; }
  .body { text-align: center; max-width: 860px; margin: 0 auto; line-height: 1.7; color: #374151; }
  .info { text-align: center; margin-top: 24px; font-weight: 600; }
  .sign { margin-top: 56px; text-align: center; }
  .tagline { text-align: center; max-width: 860px; margin: 18px auto 0; color: #4b5563; font-style: italic; font-size: .94rem; line-height: 1.6; }
  .sig-img { display: block; width: 220px; max-width: 60%; height: auto; margin: 0 auto 8px; object-fit: contain; }
  .line { width: 260px; border-top: 1.5px solid #111827; margin: 0 auto 8px; }
  .controls { position: fixed; top: 14px; left: 50%; transform: translateX(-50%); background: #fff; border: 1px solid #d1d5db; border-radius: 999px; padding: 8px 14px; display: flex; gap: 8px; }
  .btn { border: 0; border-radius: 999px; padding: 8px 14px; font-weight: 700; cursor: pointer; }
  .p { background: #1d4ed8; color: #fff; } .s { background: #6b7280; color: #fff; }
  @media print { .controls { display: none; } body { background: #fff; padding: 0; } .sheet { box-shadow: none; } }
</style>
</head>
<body>
<div class="controls"><button class="btn p" onclick="window.print()">Print</button><button class="btn s" onclick="window.close()">Close</button></div>
<div class="sheet"><div class="inner">
  <div class="title">MEMBERSHIP CERTIFICATE</div>
  <div class="subtitle">HACK UNIVERSITY INITIATIVE</div>
  <div class="presented">This is to certify that</div>
  <div class="name">${escapeHtml(c.participantName || "Student Name")}</div>
  <div class="body">Is an official member of <strong>${escapeHtml(ALL_ORGS_TEXT)}</strong>, recognized for their commitment to collaborative learning, innovation, and multi-disciplinary technology development across student organizations and initiatives.</div>
  <div class="info">Member Since: ${escapeHtml(c.memberDateSince || "Not specified")}<br>Membership ID: ${escapeHtml(c.membershipID || "Not available")}</div>
  <div class="tagline">Join us in shaping the future of technology through collaboration, learning, and innovation across multiple communities in the Hack University Initiative.</div>
  <div class="sign">
    <img class="sig-img" src="${escapeHtml(SIGNATURE_URL)}" alt="Brian Bazurto signature">
    <div class="line"></div>
    <div>
      <strong>BRIAN BAZURTO</strong><br>
      <small>President, ${escapeHtml(ALL_ORGS_TEXT)}</small>
    </div>
  </div>
</div></div>
</body>
</html>`;

      const win = window.open("", "_blank", "width=1200,height=800,scrollbars=yes,resizable=yes");
      if (!win) return alert("Please allow pop-ups to view and print your certificate.");
      win.document.write(certificateHTML);
      win.document.close();
      win.focus();
    }

    form.addEventListener("submit", verifyMembership);
    downloadBtn.addEventListener("click", downloadCertificate);

    (function navToggle() {
      const toggleBtn = document.querySelector(".nav-toggle");
      const navLinks = document.getElementById("huNavLinks");
      if (!toggleBtn || !navLinks) return;
      const setExpanded = (expanded) => {
        toggleBtn.setAttribute("aria-expanded", String(expanded));
        navLinks.classList.toggle("is-open", expanded);
        const icon = toggleBtn.querySelector("i");
        if (icon) icon.className = expanded ? "fa-solid fa-xmark" : "fa-solid fa-bars";
      };
      toggleBtn.addEventListener("click", () => {
        const expanded = toggleBtn.getAttribute("aria-expanded") === "true";
        setExpanded(!expanded);
      });
      navLinks.addEventListener("click", (e) => {
        const a = e.target.closest("a");
        if (!a) return;
        const href = a.getAttribute("href") || "";
        if (href.startsWith("#")) setExpanded(false);
      });
      window.addEventListener("resize", () => {
        if (window.innerWidth > 768) setExpanded(false);
      });
      setExpanded(false);
    })();

    (function startETClock() {
      const clockEl = document.getElementById("et-clock");
      const dateEl = document.getElementById("et-date");
      if (!clockEl || !dateEl) return;
      const tz = "America/New_York";
      const tick = () => {
        const now = new Date();
        const timeStr = new Intl.DateTimeFormat("en-US", { timeZone: tz, hour: "numeric", minute: "2-digit", second: "2-digit", hour12: true }).format(now);
        const dateStr = new Intl.DateTimeFormat("en-US", { timeZone: tz, weekday: "short", month: "short", day: "numeric", year: "numeric" }).format(now);
        clockEl.textContent = `${timeStr} ET`;
        dateEl.textContent = dateStr;
      };
      tick();
      setInterval(tick, 1000);
    })();
  </script>
</body>
</html>

