<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Volunteer Login â€¢ Code Crunch</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Google Sans','Roboto',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#f8f9fa;color:#202124;min-height:100vh}
    /* NAV */
    .navbar{background:#fff;border-bottom:1px solid #e8eaed;padding:12px 0;position:sticky;top:0;z-index:100}
    .nav-container{max-width:1100px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}
    .nav-brand a{color:#4285f4;text-decoration:none;font-size:22px;font-weight:600}
    .nav-links{display:flex;gap:20px;flex-wrap:wrap}
    .nav-link{color:#5f6368;text-decoration:none;font-size:14px;padding:8px 12px;border-radius:6px}
    .nav-link:hover{background:#f1f3f4;color:#1a73e8}

    /* Timezone band */
    .timezone-section{background:#ffffff;border-bottom:1px solid #e8eaed;padding:24px 20px;margin-bottom:24px}
    .timezone-header{text-align:center;margin-bottom:18px}
    .timezone-header h2{color:#202124;font-size:24px;font-weight:600}
    .timezone-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;max-width:1100px;margin:0 auto}
    .timezone-item{background:#ffffff;border:1px solid #dadce0;border-radius:8px;padding:14px;text-align:center;transition:all .2s ease}
    .timezone-item:hover{box-shadow:0 1px 6px rgba(32,33,36,.28)}
    .timezone-flag{font-size:18px;margin-bottom:6px}
    .timezone-time{font-size:16px;font-weight:600;color:#1a73e8;margin-bottom:4px;font-family:'Roboto Mono',monospace}
    .timezone-location{color:#5f6368;font-size:12px}

    /* Main */
    .container{max-width:1100px;margin:0 auto;padding:24px}
    .header{text-align:center;margin:24px 0}
    .header h1{font-size:32px;font-weight:600}
    .header p{margin-top:10px;color:#5f6368;line-height:1.6}
    .surface{background:#fff;border:1px solid #dadce0;border-radius:12px;padding:24px}
    .title{font-size:22px;font-weight:600;text-align:center;margin-bottom:8px}
    .subtitle{text-align:center;color:#5f6368}
    .helper{background:#fff7ed;border:1px solid #ffedd5;color:#7c2d12;border-radius:8px;padding:12px;margin:16px 0}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .email-input{flex:1 1 320px;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px}
    .email-input:focus{outline:none;border-color:#1a73e8;box-shadow:0 0 0 3px rgba(26,115,232,.15)}
    .btn{padding:12px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:#1a73e8;color:#fff}
    .btn-primary:hover{background:#1557b0}
    #result{margin-top:16px;background:#111827;color:#d1fae5;border-radius:12px;padding:16px;font-family:monospace}
    .info-box{background:#1a1a2e;border-left:4px solid #ffa500;border-radius:8px;padding:12px;margin-bottom:12px;color:#fff}
    .card-welcome{background:#0f172a;border-left:4px solid #00ff99;border-radius:8px;padding:16px;margin:12px 0}
    .cta{display:grid;gap:8px;margin:10px 0}
    .cta a{display:block;text-align:center;color:#fff;text-decoration:none;font-weight:700;padding:10px 14px;border-radius:8px}
    .cta-discord{background:linear-gradient(45deg,#7289da,#5865f2)}
    .cta-private{background:linear-gradient(45deg,#43b581,#4caf50)}
    .card-yes{background:#052e16;border-left:4px solid #00ff99;border-radius:8px;padding:12px;margin-top:8px}
    .card-no{background:#3f1d1d;border-left:4px solid #ff6b6b;border-radius:8px;padding:12px;margin-top:8px}

    /* Resources */
    .resources{margin-top:28px;display:none}
    .resources h2{font-size:20px;margin-bottom:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
    .res-card{background:#fff;border:1px solid #dadce0;border-radius:10px;padding:16px}
    .res-card h3{font-size:16px;margin-bottom:6px;display:flex;align-items:center;gap:8px}
    .res-card p{color:#5f6368;font-size:14px;line-height:1.5;margin-bottom:10px}
    .res-card a{display:inline-block;background:#1a73e8;color:#fff;text-decoration:none;padding:8px 12px;border-radius:8px;font-weight:600}
    .res-card a:hover{background:#1557b0}
    .res-locked{opacity:.6;filter:grayscale(1)}
    .res-locked .lock{color:#d33b01}

    /* Footer (Hack University) */
    .cc-blue{background:#1a73e8}
    .footer{color:#fff;padding:32px 0 48px 0;margin-top:40px}
    .footer-container{max-width:1200px;margin:0 auto;padding:0 20px}
    .footer-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px;margin-bottom:32px}
    .footer h3{font-size:18px;font-weight:500;margin-bottom:16px;color:#fff}
    .footer p{font-size:14px;opacity:.9;margin-bottom:16px;line-height:1.5}
    .footer ul{list-style:none;padding:0;margin:0}
    .footer li{margin-bottom:8px}
    .footer a{color:#fff;text-decoration:none;font-size:14px;opacity:.9;transition:opacity .2s ease}
    .footer a:hover{opacity:1}
    .social-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:16px}
    .social-link{display:flex;flex-direction:column;align-items:center;color:#fff;text-decoration:none;padding:8px;transition:color .2s ease}
    .social-link:hover{color:#fbbf24}
    .social-link i{font-size:18px;margin-bottom:4px}
    .social-link span{font-size:11px;text-align:center}
    .footer-bottom{margin-top:32px;padding-top:24px;border-top:1px solid rgba(255,255,255,.2);text-align:center}
    .footer-bottom p{font-size:14px;opacity:.9;margin-bottom:8px}
    .footer-bottom .credits{font-size:12px;opacity:.85}

    @media (max-width:520px){.container{padding:16px}}
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <a href="https://codecrunchglobal.vercel.app" target="_blank" rel="noopener"><strong>Code Crunch</strong></a>
      </div>
      <div class="nav-links">
        <a href="https://colorstackatfiu.vercel.app/" class="nav-link">ColorStack at FIU</a>
        <a href="https://cahsiatfiu.vercel.app/" class="nav-link">CAHSI at FIU</a>
        <a href="https://gdgatfiu.vercel.app/" class="nav-link">Google Developer Group at FIU</a>
        <a href="https://raspberrypicrunch.vercel.app/" class="nav-link">Raspberry Pi Code Crunch</a>
        <a href="https://codecrunchglobal.vercel.app/hackuniversitydonate.html" class="nav-link">Support Us</a>
      </div>
    </div>
  </nav>

  <!-- TIMEZONE BAND -->
  <div class="timezone-section">
    <div class="timezone-header">
      <h2>ğŸ† Hackathon HQ</h2>
    </div>
    <div class="timezone-grid">
      <div class="timezone-item">
        <div class="timezone-flag">ğŸ‡ºğŸ‡¸ - HQ</div>
        <div class="timezone-time" id="miami-time">--:--:--</div>
        <div class="timezone-location">Miami, FL (EST)</div>
      </div>
      <div class="timezone-item">
        <div class="timezone-flag">ğŸ‡ªğŸ‡º</div>
        <div class="timezone-time" id="london-time">--:--:--</div>
        <div class="timezone-location">London (GMT)</div>
      </div>
      <div class="timezone-item">
        <div class="timezone-flag">ğŸŒ</div>
        <div class="timezone-time" id="lagos-time">--:--:--</div>
        <div class="timezone-location">Lagos (WAT)</div>
      </div>
      <div class="timezone-item">
        <div class="timezone-flag">ğŸŒ</div>
        <div class="timezone-time" id="tokyo-time">--:--:--</div>
        <div class="timezone-location">Tokyo (JST)</div>
      </div>
      <div class="timezone-item">
        <div class="timezone-flag">ğŸ‡¦ğŸ‡º</div>
        <div class="timezone-time" id="sydney-time">--:--:--</div>
        <div class="timezone-location">Sydney (AEDT)</div>
      </div>
      <div class="timezone-item">
        <div class="timezone-flag">ğŸ‡®ğŸ‡³</div>
        <div class="timezone-time" id="mumbai-time">--:--:--</div>
        <div class="timezone-location">Mumbai (IST)</div>
      </div>
    </div>
  </div>

  <main class="container">
    <!-- Header -->
    <section class="header">
      <h1>Volunteer Login</h1>
      <p class="subtitle">
        Use the same email you confirmed with on <strong>Form No. 2</strong>. Weâ€™ll check it against the volunteer list.
      </p>
    </section>

    <!-- Login -->
    <section class="surface" id="volunteer-login">
      <div class="helper">
        <strong>Accepted Volunteers Only:</strong> Access is restricted to current volunteers who have been accepted and completed Form No. 2.
      </div>

      <div class="row">
        <input id="emailInput" class="email-input" type="email" placeholder="your@email.com"/>
        <button class="btn btn-primary" onclick="checkOfficialVolunteerStatus()">Sign In</button>
      </div>

      <div id="result" style="margin-top:12px;">
        <div class="info-box">
          <strong>ğŸ“‹ What you'll have access to:</strong><br/>
          â€¢ Link to join the official Discord server<br/>
          â€¢ Steps to access the private volunteer channel<br/>
          â€¢ Direct link to verify access to the private volunteer channel (all communications and updates are handled here)<br/>
          <!-- â€¢ Event registration forms (all volunteers)<br/>
          â€¢ Event registration response sheet (all volunteers)<br/>
          â€¢ Hackathon judge evaluation forms (access available only to registered volunteers)<br/>
          â€¢ Volunteer certificates page (all volunteers â€” certificates are issued only to those who complete their volunteering duties) -->
        </div>
        Awaiting emailâ€¦
      </div>
    </section>

    <!-- Resources (locked until verified) -->
    <!-- <section class="resources" id="resources">
      <h2>Volunteer Resources</h2>
      <div class="grid">
        <div class="res-card res-locked" id="card-cert">
          <h3><i class="fa-solid fa-certificate"></i> Certificates <span class="lock">ğŸ”’</span></h3>
          <p>Access or verify volunteer participation certificates.</p>
          <a href="#" id="link-cert" target="_blank" rel="noopener" aria-disabled="true">Open</a>
        </div>
        <div class="res-card res-locked" id="card-expo">
          <h3><i class="fa-solid fa-file-lines"></i> Event Registration Forms <span class="lock">ğŸ”’</span></h3>
          <p>Hack and event registration forms.</p>
          <a href="#" id="link-expo" target="_blank" rel="noopener" aria-disabled="true">Open</a>
        </div>
        <div class="res-card res-locked" id="card-resp">
          <h3><i class="fa-solid fa-table-list"></i> Event Registration Response Sheet <span class="lock">ğŸ”’</span></h3>
          <p>Review registration responses compiled from the event form.</p>
          <a href="#" id="link-resp" target="_blank" rel="noopener" aria-disabled="true">Open</a>
        </div>
        <div class="res-card res-locked" id="card-eval">
          <h3><i class="fa-solid fa-clipboard-check"></i> Hackathon Evaluation <span class="lock">ğŸ”’</span></h3>
          <p>Judging evaluation forms (access granted only to volunteers registered by each event).</p>
          <a href="#" id="link-eval" target="_blank" rel="noopener" aria-disabled="true">Open</a>
        </div>
      </div>
    </section> -->
  </main>

  <!-- FOOTER (Hack University) -->
  <footer class="cc-blue footer">
    <div class="footer-container">
      <div class="footer-grid">
        <div>
          <h3>Hack University <span>ğŸ‘¨ğŸ»â€ğŸ’» ğŸ‘¨ğŸ¼â€ğŸ’» ğŸ‘¨ğŸ½â€ğŸ’» ğŸ‘¨ğŸ¾â€ğŸ’» ğŸ‘¨ğŸ¿â€ğŸ’»ğŸ‘©ğŸ»â€ğŸ’» ğŸ‘©ğŸ¼â€ğŸ’» ğŸ‘©ğŸ½â€ğŸ’» ğŸ‘©ğŸ¾â€ğŸ’» ğŸ‘©ğŸ¿â€ğŸ’»ğŸ§‘ğŸ»â€ğŸ’» ğŸ§‘ğŸ¼â€ğŸ’» ğŸ§‘ğŸ½â€ğŸ’» ğŸ§‘ğŸ¾â€ğŸ’» ğŸ§‘ğŸ¿â€ğŸ’»</span></h3>
          <p>
            A collaborative effort uniting multiple student organizations and global communities with a mission to empower the next generation of innovators, developers, and leaders.
          </p>
          <p><a href="#">HackUniversity.vercel.app</a></p>

          <div>
            <h4 style="font-size:14px;font-weight:500;margin-bottom:12px;">Connect With Us:</h4>
            <div class="social-grid">
              <a href="#" class="social-link"><i class="fab fa-linkedin"></i><span>LinkedIn</span></a>
              <a href="#" class="social-link"><i class="fab fa-instagram"></i><span>Instagram</span></a>
              <a href="#" class="social-link"><i class="fab fa-github"></i><span>GitHub</span></a>
              <a href="#" class="social-link"><i class="fab fa-youtube"></i><span>YouTube</span></a>
              <a href="#" class="social-link"><i class="fab fa-discord"></i><span>Discord</span></a>
              <a href="#" class="social-link"><i class="far fa-calendar-alt"></i><span>Calendar</span></a>
            </div>
          </div>
        </div>

        <div>
          <h3>Quick Links</h3>
          <ul>
            <li><a href="#">Mission</a></li>
            <li><a href="#">Events</a></li>
            <li><a href="#">Hackathons</a></li>
            <li><a href="#">Membership</a></li>
            <li><a href="#">Join E-Board</a></li>
            <li><a href="#">Resources</a></li>
            <li><a href="#">Join Discord</a></li>
          </ul>
        </div>

        <div>
          <h3>Contact</h3>
          <div style="font-size:14px;opacity:.9;">
            Miami, FL<br/>
            <a href="mailto:codecrunchclub@gmail.com">codecrunchclub@gmail.com</a>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <p>Â© <span id="year"></span> Hack University. All rights reserved.</p>
        <div class="credits">
          Built with â¤ï¸ for the tech community by <a href="#" target="_blank">Brian Bazurto</a> | Powered by innovation and collaboration
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== CONFIG ======
    const ALLOWED_HOST = "codecrunchglobal.vercel.app";
    const API_URL = "https://script.google.com/macros/s/AKfycbzMz7yJrBVBYKVPTZCHP408ffEG3rhxj_0bVj4ldX72r1QAKjujd6ue61alOVuEO16XqA/exec";
    const USE_API_KEY = false;
    const API_KEY     = "REPLACE_WITH_SECURE";

    // Optional fallbacks if API doesn't send a link
    const RESOURCE_LINKS_FALLBACK = {
      certificates: "#",
      responses:    "#",
      evaluation:   "#",
      registration:         "#"
    };

    // Prefill email from ?email=
    const prefill = new URLSearchParams(location.search).get('email');
    if (prefill) document.getElementById('emailInput').value = prefill;

    function domainOK() {
      const ok = window.location.hostname === ALLOWED_HOST;
      if (!ok) {
        document.getElementById('result').innerHTML =
          `<div class="info-box">âŒ This portal only works on <strong>${ALLOWED_HOST}</strong>.</div>`;
      }
      return ok;
    }

    function infoBoxHTML(){ return `
      <div class="info-box">
        <strong>ğŸ“‹ Email Verification:</strong><br>
        â€¢ Use the email you used to register and confirm on <strong>Form No. 2</strong><br>
        â€¢ Accepted volunteers only (Judges, Mentors, Speakers, Organizers)
      </div>`; }

    // Apply resource links from API (with fallback)
    function applyResourceLinksFromAPI(entry) {
      const cert = entry.certificatesLink || RESOURCE_LINKS_FALLBACK.certificates;
      const resp = entry.eventRegistrationResponseSheetLink || RESOURCE_LINKS_FALLBACK.responses;
      const evalL = entry.hackathonEvaluationFormsLink || RESOURCE_LINKS_FALLBACK.evaluation;
      // âœ… fix: use eventRegistrationLink (optionally fall back to expoFormsLink if you had an older version)
      const reg   = entry.eventRegistrationLink || RESOURCE_LINKS_FALLBACK.registration;

      document.getElementById('resources').style.display = 'block';

      const map = [
        { card: 'card-cert', link: 'link-cert', href: cert },
        { card: 'card-resp', link: 'link-resp', href: resp },
        { card: 'card-eval', link: 'link-eval', href: evalL },
        { card: 'card-expo', link: 'link-expo', href: reg } // â† this is the â€œEvent Registration Forms â†’ Openâ€ button
      ];

      map.forEach(({card, link, href}) => {
        const cardEl = document.getElementById(card);
        const aEl = document.getElementById(link);
        aEl.href = href || "#";
        aEl.removeAttribute('aria-disabled');
        cardEl.classList.remove('res-locked');
        const lock = cardEl.querySelector('.lock');
        if (lock) lock.remove();
      });
    }

    async function checkOfficialVolunteerStatus() {
      if (!domainOK()) return;

      const email = (document.getElementById('emailInput').value || '').trim();
      const resultDiv = document.getElementById('result');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

      if (!email) { resultDiv.innerHTML = infoBoxHTML() + 'âŒ Please enter your email.'; return; }
      if (!emailRegex.test(email)) { resultDiv.innerHTML = infoBoxHTML() + 'âŒ Please enter a valid email.'; return; }

      resultDiv.innerHTML = infoBoxHTML() + 'â³ Verifying your volunteer statusâ€¦';

      try {
        const url = new URL(API_URL);
        url.searchParams.set('email', email);
        url.searchParams.set('referer', window.location.href);
        url.searchParams.set('details', '0');
        if (USE_API_KEY) url.searchParams.set('key', API_KEY);

        const resp = await fetch(url.toString());
        const data = await resp.json();

        if (data.error) { resultDiv.innerHTML = infoBoxHTML() + `âŒ Error: ${data.error}`; return; }
        if (!Array.isArray(data)) { resultDiv.innerHTML = infoBoxHTML() + 'âŒ Unexpected response. Try again later.'; return; }

        let html = infoBoxHTML() + `<strong>Login for ğŸ“§ <span style="color:#fff">${email}</span>:</strong><br/>`;

        if (data.length > 0 && data[0].status && data[0].status !== "No entry") {
          data.forEach(entry => {
            if (entry.discordInstructions && entry.discordJoinLink && entry.privateChannelLink) {
              html += `<div class="card-wwelcome card-welcome">
                        <strong style="color:#00ff99;font-size:1.05em;">ğŸ‰ Access Granted â€” Welcome!</strong><br/><br/>
                        <div class="cta">
                          <a class="cta-discord" href="${entry.discordJoinLink}" target="_blank" rel="noopener">ğŸš€ JOIN DISCORD SERVER</a>
                          <a class="cta-private" href="${entry.privateChannelLink}" target="_blank" rel="noopener">ğŸ”’ CHECK PRIVATE CHANNEL ACCESS</a>
                        </div>` +
                        entry.discordInstructions
                          .replace(/\n/g,'<br/>')
                          .replace(/\*\*(.*?)\*\*/g,'<strong style="color:#fff">$1</strong>')
                          .replace(/`(.*?)`/g,'<code style="background:#333;padding:2px 6px;border-radius:3px;color:#ffaa00;">$1</code>') +
                      `</div>`;
            }

            html += `<div class="card-yes">
                      <strong>âœ… Confirmed Volunteer</strong><br/>
                      â€¢ Status: ${entry.status}<br/>
                      â€¢ Form-2 Timestamp: ${entry.timestamp}<br/>
                      â€¢ Email: ${entry.email}<br/>` +
                      (entry?.basicInfo?.position && entry.basicInfo.position!=="Not available" ? `â€¢ Position: ${entry.basicInfo.position}<br/>` : '') +
                      (entry?.basicInfo?.company && entry.basicInfo.company!=="Not available" ? `â€¢ Company: ${entry.basicInfo.company}<br/>` : '') +
                      (entry?.basicInfo?.discordUsername && entry.basicInfo.discordUsername!=="Not available" ? `â€¢ Discord: ${entry.basicInfo.discordUsername}<br/>` : '') +
                      (entry?.basicInfo?.githubProfile && entry.basicInfo.githubProfile!=="Not available" ? `â€¢ GitHub: <a href="${entry.basicInfo.githubProfile}" target="_blank" style="color:#00ff99;">${entry.basicInfo.githubProfile}</a><br/>` : '') +
                    `</div>`;

            applyResourceLinksFromAPI(entry);
          });

          resultDiv.innerHTML = html;

        } else {
          html += `<div class="card-no">
                    <strong>âŒ Access Denied</strong><br/>
                    â€¢ We could not find a confirmed Form-2 entry for this email.<br/>
                    â€¢ This portal is restricted to current, accepted volunteers who completed Form No. 2.
                  </div>`;
          resultDiv.innerHTML = html;
        }

      } catch (err) {
        console.error(err);
        resultDiv.innerHTML = infoBoxHTML() + 'âŒ Network error. Please try again later.';
      }
    }

    // Live time updates for the timezone band
    function updateTimes() {
      const now = new Date();
      const set = (id, tz) => {
        const t = new Date(now.toLocaleString("en-US",{timeZone:tz}));
        const hh = String(t.getHours()).padStart(2,'0');
        const mm = String(t.getMinutes()).padStart(2,'0');
        const ss = String(t.getSeconds()).padStart(2,'0');
        const out = `${hh}:${mm}:${ss}`;
        const el = document.getElementById(id);
        if (el) el.textContent = out;
      };
      set('miami-time',"America/New_York");
      set('london-time',"Europe/London");
      set('lagos-time',"Africa/Lagos");
      set('tokyo-time',"Asia/Tokyo");
      set('sydney-time',"Australia/Sydney");
      set('mumbai-time',"Asia/Kolkata");
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      updateTimes();
      setInterval(updateTimes, 1000);
    });

    // Enter to submit
    document.getElementById('emailInput').addEventListener('keypress',(e)=>{
      if (e.key === 'Enter') checkOfficialVolunteerStatus();
    });
  </script>
</body>
</html>
